# Elastic Beanstalk Configuration for PelangiManager
# This configures environment variables, health checks, and container settings

option_settings:
  # Application Load Balancer configuration
  aws:elbv2:loadbalancer:
    IdleTimeout: 60
  
  # Auto Scaling configuration  
  aws:autoscaling:asg:
    MinSize: 1
    MaxSize: 4
    Cooldown: 300
  
  # Auto Scaling trigger configuration
  aws:autoscaling:trigger:
    MeasureName: CPUUtilization
    Unit: Percent
    UpperThreshold: 70
    LowerThreshold: 20
    ScaleUpIncrement: 1
    ScaleDownIncrement: -1
  
  # Environment variables for the application
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 8080
    # Database connection will be set via AWS RDS integration
    # SESSION_SECRET: "your-session-secret-here"
    
  # Health check configuration
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
    
  # Container configuration
  aws:elasticbeanstalk:container:nodejs:
    NodeCommand: "npm start"
    NodeVersion: 18.18.2
    
  # CloudWatch Logs configuration
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 7
    
  # Application health check
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/database/config
    HealthCheckTimeout: 10
    HealthyThresholdCount: 2
    UnhealthyThresholdCount: 5
    Interval: 30
    
  # Instance configuration
  aws:ec2:instances:
    InstanceTypes: t3.micro,t3.small